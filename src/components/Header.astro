---
import Icon from './Icon.astro';
import { siteConfig } from '@/config/site';

interface NavLink {
  label: string;
  href: string;
  active?: boolean;
}

interface Props {
  brandName?: string;
  brandHref?: string;
  navLinks?: NavLink[];
}

const {
  brandName = siteConfig.name,
  brandHref = "/",
  navLinks = [
    { label: "Services", href: "/services" },
    { label: "About", href: "/about" },
    { label: "Our Approach", href: "/our-service-model" },
    { label: "Contact", href: "/contact" }
  ],
} = Astro.props as Props;

// Determine active link based on current path
const currentPath = Astro.url.pathname;
const activeNavLinks = navLinks.map(link => ({
  ...link,
  active: currentPath === link.href || currentPath === link.href + '/'
}));
---

<header class="sticky top-0 z-50 w-full bg-primary transition-all duration-300">
  <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between h-20">
      <!-- Brand / Logo -->
      <a href={brandHref} class="flex items-center gap-3 group">
        <!-- Logo mark: two circles -->
        <div class="flex items-center gap-1">
          <span class="h-3 w-3 rounded-full border-2 border-primary-foreground"></span>
          <span class="h-3 w-3 rounded-full bg-primary-foreground"></span>
        </div>
        <span class="text-xl font-semibold tracking-tight text-primary-foreground">
          {brandName}
        </span>
      </a>

      <!-- Desktop navigation -->
      <div class="hidden md:flex items-center">
        <ul class="flex items-center gap-8 text-sm font-medium">
          {activeNavLinks.map((link) => (
            <li>
              <a
                href={link.href}
                class={`py-2 transition-all ${
                  link.active 
                    ? "text-primary-foreground font-semibold underline decoration-accent underline-offset-4" 
                    : "text-primary-foreground/70 hover:font-semibold"
                }`}
              >
                {link.label}
              </a>
            </li>
          ))}
        </ul>
      </div>

      <!-- Mobile menu button -->
      <button
        type="button"
        class="hs-collapse-toggle md:hidden inline-flex items-center justify-center rounded-lg p-2 text-primary-foreground hover:bg-primary-foreground/10 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary-foreground"
        data-hs-collapse="#mobile-nav"
        aria-controls="mobile-nav"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="sr-only">Toggle navigation</span>
        <Icon
          name="tabler:menu-2"
          class="hs-collapse-open:hidden h-6 w-6"
        />
        <Icon
          name="tabler:x"
          class="hs-collapse-open:block hidden h-6 w-6"
        />
      </button>
    </div>

    <!-- Mobile navigation -->
    <div id="mobile-nav" class="hs-collapse hidden overflow-hidden transition-all duration-300 basis-full grow md:hidden bg-primary">
      <div class="pb-6 pt-2 space-y-1">
        {activeNavLinks.map((link) => (
          <a
            href={link.href}
            class={`block rounded-lg px-4 py-3 text-base font-medium transition-all hover:bg-primary-foreground/10 ${
              link.active 
                ? "text-primary-foreground font-semibold underline decoration-accent underline-offset-4" 
                : "text-primary-foreground/80 hover:font-semibold"
            }`}
          >
            {link.label}
          </a>
        ))}
      </div>
    </div>
  </nav>
</header>

<script>
  // Add subtle shadow on scroll
  const header = document.querySelector('header');

  window.addEventListener('scroll', () => {
    if (window.scrollY > 10) {
      header?.classList.add('shadow-md');
    } else {
      header?.classList.remove('shadow-md');
    }
  });
</script>
