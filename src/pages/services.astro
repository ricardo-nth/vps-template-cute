---
import SiteLayout from '@layouts/SiteLayout.astro';
import { getEntry } from 'astro:content';
import PageHero from '@components/PageHero.astro';
import ServicesOverview from '@components/ServicesOverview.astro';
import SupportedLivingFeatures from '@components/SupportedLivingFeatures.astro';
import ServiceSpecialties from '@components/ServiceSpecialties.astro';
import CompliancePillars from '@components/CompliancePillars.astro';
import ContactSection from '@components/ContactSection.astro';
import unsplashApproach from '@assets/images/unsplash-approach.jpg';
import unsplashHealthcare1 from '@assets/images/unsplash-healthcare-1.jpg';
import unsplashHealthcare2 from '@assets/images/unsplash-healthcare-2.jpg';
import unsplashHealthcare3 from '@assets/images/unsplash-healthcare-3.jpg';
import unsplashHealthcare4 from '@assets/images/unsplash-healthcare-4.jpg';
import unsplashHealthcare5 from '@assets/images/unsplash-healthcare-5.jpg';
import unsplashHealthcare6 from '@assets/images/unsplash-healthcare-6.jpg';

const servicesEntry = await getEntry('cuteServices', 'default');
const servicesDomEntry = await getEntry('cuteServices', 'dom-care');
if (!servicesEntry) {
  throw new Error('Missing content entry: cuteServices/default');
}
if (!servicesDomEntry) {
  throw new Error('Missing content entry: cuteServices/dom-care');
}

const profiles = [
  { key: 'supported-living', content: servicesEntry.data },
  { key: 'dom-care', content: servicesDomEntry.data },
] as const;

// Image mapping for specialties
const imageMap: Record<string, ImageMetadata> = {
  'unsplash-approach': unsplashApproach,
  'unsplash-healthcare-1': unsplashHealthcare1,
  'unsplash-healthcare-2': unsplashHealthcare2,
  'unsplash-healthcare-3': unsplashHealthcare3,
  'unsplash-healthcare-4': unsplashHealthcare4,
  'unsplash-healthcare-5': unsplashHealthcare5,
  'unsplash-healthcare-6': unsplashHealthcare6,
};
---

<SiteLayout metadata={servicesEntry.data.metadata}>
  <div data-care-profile-switcher>
    {profiles.map(({ key, content }) => (
      <div data-care-profile-panel={key} class:list={{ hidden: key !== 'supported-living' }}>
        <PageHero
          heading={content.hero.heading}
          subheading={content.hero.subheading}
          primaryCtaText={content.hero.primaryCtaText}
          primaryCtaHref={content.hero.primaryCtaHref}
          secondaryCtaText={content.hero.secondaryCtaText}
          secondaryCtaHref={content.hero.secondaryCtaHref}
          imageSrc={imageMap[content.hero.imageKey] || unsplashApproach}
          imageAlt={content.hero.imageAlt}
        />

        <ServicesOverview
          eyebrow={content.servicesOverview.eyebrow}
          heading={content.servicesOverview.heading}
          intro={content.servicesOverview.intro}
          services={content.servicesOverview.services}
          sectionId="service-categories"
        />

        <section id="features">
          <SupportedLivingFeatures
            heading={content.supportedLivingFeatures.heading}
            subheading={content.supportedLivingFeatures.subheading}
            features={content.supportedLivingFeatures.features}
          />
        </section>

        <ServiceSpecialties
          heading={content.serviceSpecialties.heading}
          subheading={content.serviceSpecialties.subheading}
          specialties={content.serviceSpecialties.specialties.map(({ imageKey, ...specialty }) => ({
            ...specialty,
            imageSrc: imageMap[imageKey] || unsplashApproach,
          }))}
        />

        <CompliancePillars
          heading={content.compliancePillars.heading}
          subheading={content.compliancePillars.subheading}
          pillars={content.compliancePillars.pillars}
        />

        <ContactSection
          heading={content.contactSection.heading}
          intro={content.contactSection.intro}
          phoneLabel={content.contactSection.phoneLabel}
          phoneHref={content.contactSection.phoneHref}
          emailLabel={content.contactSection.emailLabel}
          emailHref={content.contactSection.emailHref}
          address={content.contactSection.address}
        />
      </div>
    ))}
  </div>
</SiteLayout>
